// --------------------------------
//   Progress Components
// --------------------------------

@use '../config';
@use '../api' as *;

// --------------------------------
//   Vars
// --------------------------------

$class: '.progress';

// Defaults
$height: 12px;

// --------------------------------
//   Mixins
// --------------------------------

@mixin progress-bar {
  &::-webkit-progress-bar {
    background-color: var(--koi-progress-background);
    border-radius: var(--koi-progress-radius);
    box-shadow: inset shadow(sm);
  }

  &::-webkit-progress-value {
    background-color: accent(6);
    border-radius: var(--koi-progress-radius);

    // @include stripes;
  }

  &::-moz-progress-bar {
    background-color: accent(6);
    border-radius: var(--koi-progress-radius);
  }

  // &:indeterminate::after {
  // content: '';
  // @apply bg-neutral;
  // @apply inset-y-0 -left-[40%] w-1/3 absolute rounded-box;
  // animation: progress-loading 5s infinite ease-in-out;
  // }

  // &::-webkit-progress-bar {
  // @apply bg-neutral bg-opacity-20 rounded-box;
  // }

  // &::-webkit-progress-value {
  // @apply bg-neutral-focus rounded-box;
  // }
}

@mixin undetermined {
  // background-color: var(--koi-progress-indeterminate-background);
  background: #f44;
}

// @mixin stripes {
//   background-image: linear-gradient(
//       -45deg,
//       transparent 33%,
//       rgb(0 0 0 / 0.1) 33%,
//       rgb(0 0 0 / 0.1) 66%,
//       transparent 66%
//     ),
//     linear-gradient(top, rgb(255 255 255 / 0.25), rgb(0 0 0 / 0.25)), linear-gradient(left, #09c, #f44);
//   background-size: 35px 20px, 100% 100%, 100% 100%;
// }

@mixin reset {
  appearance: none;
  border: 0;
  overflow: hidden;
  position: relative;
  width: 100%;
}

@mixin base {
  --koi-progress-height: #{$height};
  --koi-progress-radius: #{radius(full)};
  --koi-progress-background: #{fill(cnt, 9, $alpha: 0.1)};
  --koi-progress-indeterminate-background: #{fill(cnt, 9, $alpha: 0.25)};

  border-radius: var(--koi-progress-radius);
  height: var(--koi-progress-height);

  // &[value] {
  // @include progress-bar;
  // }

  &:indeterminate,
  &:not([value]) {
    border: 3px solid #f44;
    @include undetermined;
  }
}

// --------------------------------
//   Styles
// --------------------------------

@mixin styles {
  progress {
    @include reset;
    animation: animate-stripes 5s linear infinite;
  }

  #{$class} {
    @include base;
  }

  // @keyframes progress-loading {
  //   50% {
  //     left: 107%;
  //   }
  // }

  // @keyframes animate-stripes {
  //   100% {
  //     background-position: -100px 0;
  //   }
  // }
}
