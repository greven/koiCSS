// --------------------------------
//   Card Component
// --------------------------------

@use '../config';
@use '../api' as *;

// --------------------------------
//   Vars
// --------------------------------

$class: '.card';
$ignored-selectors: 'img, h2, h3, h4, h5, h6, #{$class}__section, #{$class}__header, #{$class}__footer, #{$class}__text';

// Defaults
$aspect-ratio: '3/2';

$spacing-x: fluid-spacing(14);
$spacing-y: fluid-spacing(16);

$font-size: font-size(sm);
$text-leading: text-leaidng(sm);

$border-color: fill(brd, 1);
$border-radius: radius(config.default(radius));

$body-background: fill(srf, 1);
$body-foreground: fill(txt, 2);

// --------------------------------
//   Mixins
// --------------------------------

@mixin card {
  @include box(
    $background: var(--koi-card-body-background, $body-background),
    $foreground: var(--koi-card-body-foreground, $body-foreground),
    $rounded: $border-radius,
    $shadow: md
  );
  border-color: var(--koi-card-border-color, $border-color);
  border-width: var(--koi-card-border-width, 0);
  display: flex;
  flex-direction: column;
  gap: var(--koi-card-gap, $spacing-y);

  &__section,
  &__header,
  &__footer {
    display: flex;
    font-size: var(--koi-card-font-size, $font-size);
    line-height: var(--koi-card-leading, $text-leading);
    position: relative;

    &--border {
      border-color: var(--koi-card-inner-border-color, $border-color);
      border-top-width: var(--koi-card-inner-border-width, 1px);
      padding-left: var(--koi-card-spacing-x, $spacing-x);
      padding-right: var(--koi-card-spacing-x, $spacing-x);
      padding-top: var(--koi-card-spacing-y, $spacing-y);
    }
  }

  &__header,
  &__footer {
    align-items: center;
    justify-content: space-between;
  }

  &__content {
    color: var(--koi-card-body-foreground, $body-foreground);
  }

  & > *:last-of-type:not(#{$ignored-selectors}) {
    margin-bottom: var(--koi-card-spacing-y, $spacing-y);
  }

  & > img {
    aspect-ratio: var(--koi-img-aspect-ratio, 3/2);
    object-fit: cover;
    width: 100%;

    &:first-child {
      border-radius: $border-radius $border-radius 0 0;
    }

    &:last-child {
      border-radius: 0 0 $border-radius $border-radius;
      margin-top: auto;
    }
  }

  & > *:not(img, #{$class}__section--border) {
    margin-left: var(--koi-card-spacing-x, $spacing-x);
    margin-right: var(--koi-card-spacing-x, $spacing-x);
  }

  & > *:not(img):first-child {
    margin-top: var(--koi-card-spacing-y, $spacing-y);
  }

  & > a {
    align-self: start;
  }
}

// --------------------------------
//   Styles
// --------------------------------

@mixin styles {
  #{$class} {
    @include card;
  }
}
