// --------------------------------
//   Range Slider Component
// --------------------------------

@use 'sass:math';
@use 'sass:selector';

@use '../config';
@use '../api' as *;

// --------------------------------
//   Vars
// --------------------------------

$accent-shade: config.default(color-shade);

$thumb-size: 22px;
$thumb-radius: radius(full);
$thumb-shadow: shadow();

// --------------------------------
//   Mixins
// --------------------------------

@mixin reset {
  appearance: none;
  background: transparent;
  cursor: grab;
  outline: none;

  &:focus {
    outline: none;
  }

  &::-webkit-slider-thumb,
  &::-moz-range-thumb {
    appearance: none;
    border-style: none;
  }

  &::-webkit-slider-thumb {
    top: 50%;
    transform: translateY(-50%);
  }
}

@mixin track {
  background: var(--koi-track-color, fill(cnt, 9, $alpha: 0.1));
  border-radius: var(--koi-track-radius, radius(xl));
  height: var(--koi-track-height, calc($thumb-size / 2.5));
  width: 100%;
}

@mixin thumb {
  $thumb-color: var(--koi-thumb-color, accent($accent-shade));
  $shadow: 0 0 0 99px $thumb-color inset, $thumb-shadow;

  @include transition((background-color border-color box-shadow));
  background-color: $thumb-color;
  border-radius: var(--koi-thumb-radius, $thumb-radius);
  box-shadow: var(--koi-thumb-shadow, $shadow);
  height: var(--koi-thumb-size, $thumb-size);
  position: relative;
  width: var(--koi-thumb-size, $thumb-size);
}

@mixin input-range {
  $thumb-color-hover: var(--koi-thumb-color-hover, accent($accent-shade - 2));
  $thumb-color-focus: var(--koi-thumb-color-focus, accent($accent-shade - 2));
  $focus-ring: var(
    --koi-thumb-focus-ring,
    ring(
      $width: calc($thumb-size / 3.25),
      $offset: 0px,
      $color: accent($accent-shade, $alpha: 0.25),
    )
  );

  $box-shadow-hover: 0 0 0 99px $thumb-color-hover inset, $thumb-shadow;
  $box-shadow-focus: 0 0 0 99px $thumb-color-focus inset, $thumb-shadow, $focus-ring;

  &::-webkit-slider-runnable-track {
    @include track;
  }

  &::-moz-range-track {
    @include track;
  }

  &::-webkit-slider-thumb {
    @include thumb;
  }

  &::-moz-range-thumb {
    @include thumb;
  }

  &:hover::-webkit-slider-thumb {
    box-shadow: var(--koi-thumb-shadow-hover, $box-shadow-hover);
  }

  &:focus::-webkit-slider-thumb {
    box-shadow: var(--koi-thumb-shadow-focus, $box-shadow-focus);
  }

  &:hover::-moz-range-thumb {
    box-shadow: var(--koi-thumb-shadow-hover, $box-shadow-hover);
  }

  &:focus::-moz-range-thumb {
    box-shadow: var(--koi-thumb-shadow-focus, $box-shadow-focus);
  }
}

// --------------------------------
//   Styles
// --------------------------------

@mixin styles {
  input[type='range'] {
    @include reset;
    @include input-range;
  }
}
