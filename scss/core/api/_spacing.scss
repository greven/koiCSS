// --------------------------------
//   Spacing
// --------------------------------

@use 'sass:map';
@use 'sass:list';

@use 'config' as *;
@use 'theme' as *;

// --------------------------------
//   Values
// --------------------------------

// Negative spacing (needed for negative margins)
$negative-spacing: () !default;
@each $key, $value in theme(spacing) {
  $map: ();
  $map: map.merge($map, (n#{$key}: -$value));
  $negative-spacing: map.merge($negative-spacing, $map);
}

// --------------------------------
//   Functions
// --------------------------------

/// Return a spacing value(s) from the theme
///
/// @param {string} $key - spacing key
/// @param {string} $keys - spacing keys
///
/// @return {any} `$spacing-value`.
///
@function spacing($key, $keys...) {
  $result: ();
  @if $key == 0 {
    $result: 0;
  } @else if theme-has-key(spacing, $key) {
    $result: theme(spacing, $key);
  } @else if map.has-key($negative-spacing, $key) {
    $result: map.get($negative-spacing, $key);
  } @else {
    @error "Key [#{$key}] is not a valid theme spacing.";
  }

  @each $key in $keys {
    @if $key == 0 {
      $value: 0;
      $result: list.append($result, $value);
    } @else if theme-has-key(spacing, $key) {
      $value: theme(spacing, $key);
      $result: list.append($result, $value);
    } @else if map.has-key($negative-spacing, $key) {
      $value: map.get($negative-spacing, $key);
      $result: list.append($result, $value);
    } @else {
      @error "Key(s) [#{$keys}] are not valid theme spacings.";
    }
  }

  @return $result;
}

@function responsive-spacing(
  $value: config(responsive, padding, value),
  $min: config(responsive, padding, min),
  $max: config(responsive, padding, max)
) {
  @return clamp(var(--koi-spacing-min, $min), var(--koi-spacing-value, $value), var(--koi-spacing-max, $max));
}

// --------------------------------
//   Mixins
// --------------------------------

// Margin

@mixin margin($key, $keys...) {
  margin: spacing($key, $keys...);
}

@mixin margin-inline($key, $keys...) {
  margin-left: spacing($key, $keys...);
  margin-right: spacing($key, $keys...);

  @supports (margin-block: 0) {
    margin-inline: spacing($key, $keys...);
  }
}

@mixin margin-inline-start($key) {
  margin-left: spacing($key);
  @supports (margin-block: 0) {
    margin-inline-start: spacing($key);
  }
}

@mixin margin-inline-end($key) {
  margin-right: spacing($key);
  @supports (margin-block: 0) {
    margin-inline-end: spacing($key);
  }
}

@mixin margin-block($key, $keys...) {
  margin-top: spacing($key, $keys...);
  margin-bottom: spacing($key, $keys...);
  @supports (margin-block: 0) {
    margin-block: spacing($key, $keys...);
  }
}

@mixin margin-block-start($key) {
  margin-top: spacing($key);
  @supports (margin-block: 0) {
    margin-block-start: spacing($key);
  }
}

@mixin margin-block-end($key) {
  margin-bottom: spacing($key);
  @supports (margin-block: 0) {
    margin-block-end: spacing($key);
  }
}

@mixin margin-top($key) {
  margin: spacing($key);
}

@mixin margin-bottom($key) {
  margin-bottom: spacing($key);
}

@mixin margin-left($key) {
  margin-left: spacing($key);
}

@mixin margin-right($key) {
  margin-right: spacing($key);
}

// Responsive Margin

@mixin responsive-margin {
  margin: responsive-spacing();
}

@mixin responsive-margin-inline {
  margin-left: responsive-spacing();
  margin-right: responsive-spacing();
  @supports (margin-block: 0) {
    margin-inline: responsive-spacing();
  }
}

@mixin responsive-margin-block {
  margin-top: responsive-spacing();
  margin-bottom: responsive-spacing();
  @supports (margin-block: 0) {
    margin-block: responsive-spacing();
  }
}

// Padding

@mixin padding($key, $keys...) {
  padding: spacing($key, $keys...);
}

@mixin padding-inline($key, $keys...) {
  padding-left: spacing($key, $keys...);
  padding-right: spacing($key, $keys...);
  @supports (margin-block: 0) {
    padding-inline: spacing($key, $keys...);
  }
}

@mixin padding-inline-start($key) {
  padding-left: spacing($key);
  @supports (margin-block: 0) {
    padding-inline-start: spacing($key);
  }
}

@mixin padding-inline-end($key) {
  padding-right: spacing($key);
  @supports (margin-block: 0) {
    padding-inline-end: spacing($key);
  }
}

@mixin padding-block($key, $keys...) {
  padding-top: spacing($key, $keys...);
  padding-bottom: spacing($key, $keys...);
  @supports (margin-block: 0) {
    padding-block: spacing($key, $keys...);
  }
}

@mixin padding-block-start($key) {
  padding-top: spacing($key);
  @supports (margin-block: 0) {
    padding-block-start: spacing($key);
  }
}

@mixin padding-block-end($key) {
  padding-bottom: spacing($key);
  @supports (margin-block: 0) {
    padding-block-end: spacing($key);
  }
}

@mixin padding-top($key) {
  padding: spacing($key);
}

@mixin padding-bottom($key) {
  padding-bottom: spacing($key);
}

@mixin padding-left($key) {
  padding-left: spacing($key);
}

@mixin padding-right($key) {
  padding-right: spacing($key);
}

// Responsive Padding

@mixin responsive-padding {
  padding: responsive-spacing();
}

@mixin responsive-padding-inline {
  padding-left: responsive-spacing();
  padding-right: responsive-spacing();
  @supports (margin-block: 0) {
    padding-inline: responsive-spacing();
  }
}

@mixin responsive-padding-block {
  padding-top: responsive-spacing();
  padding-bottom: responsive-spacing();
  @supports (margin-block: 0) {
    padding-block: responsive-spacing();
  }
}
